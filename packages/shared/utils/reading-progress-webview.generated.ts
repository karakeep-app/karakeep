// This file is auto-generated by scripts/build-webview-js.ts
// Do not edit manually. Run: pnpm --filter @karakeep/shared generate:webview-js
// Source: reading-progress-webview-src.ts

/**
 * WebView-compatible JavaScript for reading progress tracking.
 * Designed for React Native WebView injection.
 * Uses window-level scrolling only (no container scrolling detection).
 *
 * Exposes these functions on the __readingProgress global:
 * - normalizeText(text)
 * - normalizeTextLength(text)
 * - extractAnchorText(element)
 * - findParagraphByAnchor(container, anchor)
 * - getReadingPosition(container)
 * - scrollToReadingPosition(container, offset, behavior, anchor)
 */
export const READING_PROGRESS_WEBVIEW_JS =
  '"use strict";var __readingProgress=(()=>{var f=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var b=(e,t)=>{for(var n in t)f(e,n,{get:t[n],enumerable:!0})},k=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of A(t))!R.call(e,l)&&l!==n&&f(e,l,{get:()=>t[l],enumerable:!(r=E(t,l))||r.enumerable});return e};var P=e=>k(f({},"__esModule",{value:!0}),e);var N={};b(N,{extractAnchorText:()=>p,findParagraphByAnchor:()=>T,getReadingPosition:()=>w,normalizeText:()=>g,normalizeTextLength:()=>h,scrollToReadingPosition:()=>L});var m=["p","h1","h2","h3","h4","h5","h6","li","blockquote"],d=m.join(", ");function g(e){return e.replace(/[\\n\\r\\t]+/g," ").replace(/\\s+/g," ").trim()}function h(e){return g(e).length}function p(e){var n;let t=(n=e.textContent)!=null?n:"";return g(t).slice(0,50)}function T(e,t){if(!t)return null;let n=e.querySelectorAll(d);for(let r of n)if(p(r)===t)return r;for(let r of n)if(p(r).slice(0,20)===t.slice(0,20)&&t.length>=20)return r;return null}function w(e){var i;let t=e.querySelectorAll(d);if(t.length===0)return null;let n=0,r=null;for(let c of t){let o=c.getBoundingClientRect();if(o.top>=n){r=c;break}if(o.top<n&&o.bottom>n){r=c;break}}if(!r)return null;let l=p(r),u=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),a=0,s;for(;s=u.nextNode();){if(r.contains(s))return{offset:a,anchor:l};a+=h((i=s.textContent)!=null?i:"")}return{offset:a,anchor:l}}function L(e,t,n="smooth",r){var s;if(t<=0)return!1;if(r){let i=T(e,r);if(i)return i.scrollIntoView({behavior:n,block:"start"}),!0}let l=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),u=0,a;for(;a=l.nextNode();){let i=(s=a.textContent)!=null?s:"",c=h(i);if(c!==0){if(u+c>=t){let o=a.parentElement;for(;o&&o!==e;){let x=o.tagName.toLowerCase();if(m.includes(x))break;o=o.parentElement}if((!o||o===e)&&(o=a.parentElement),o)return o.scrollIntoView({behavior:n,block:"start"}),!0;break}u+=c}}return!1}return P(N);})();\n';
