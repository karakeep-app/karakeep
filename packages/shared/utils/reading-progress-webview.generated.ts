// This file is auto-generated by scripts/build-webview-js.ts
// Do not edit manually. Run: pnpm --filter @karakeep/shared generate:webview-js
// Sources: reading-progress-webview-src.ts, reading-progress-core.ts

/**
 * WebView-compatible JavaScript for reading progress tracking.
 * Designed for React Native WebView injection.
 * Uses window-level scrolling only (no container scrolling detection).
 *
 * Exposes these functions on the __readingProgress global:
 * - normalizeText(text)
 * - normalizeTextLength(text)
 * - extractAnchorText(element)
 * - findParagraphByAnchor(container, anchor)
 * - getReadingPosition(container)
 * - scrollToReadingPosition(container, offset, behavior, anchor)
 */
export const READING_PROGRESS_WEBVIEW_JS =
  '"use strict";var __readingProgress=(()=>{var g=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var b=(e,t)=>{for(var r in t)g(e,r,{get:t[r],enumerable:!0})},k=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of R(t))!P.call(e,l)&&l!==r&&g(e,l,{get:()=>t[l],enumerable:!(n=A(t,l))||n.enumerable});return e};var H=e=>k(g({},"__esModule",{value:!0}),e);var S={};b(S,{getReadingPosition:()=>C,scrollToReadingPosition:()=>E});var f=["p","h1","h2","h3","h4","h5","h6","li","blockquote"],h=f.join(", "),L=50;function m(e){return e.replace(/[\\n\\r\\t]+/g," ").replace(/\\s+/g," ").trim()}function d(e){return m(e).length}function p(e){var r;let t=(r=e.textContent)!=null?r:"";return m(t).slice(0,L)}function N(e,t){if(!t)return null;let r=Array.from(e.querySelectorAll(h));for(let n of r)if(p(n)===t)return n;for(let n of r)if(p(n).slice(0,20)===t.slice(0,20)&&t.length>=20)return n;return null}function x(e,t){var a;let r=Array.from(e.querySelectorAll(h));if(r.length===0)return null;let n=null;for(let s of r){let o=s.getBoundingClientRect();if(o.top>=t){n=s;break}if(o.top<t&&o.bottom>t){n=s;break}}if(!n)return null;let l=p(n),u=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),i=0,c;for(;c=u.nextNode();){if(n.contains(c))return{offset:i,anchor:l};i+=d((a=c.textContent)!=null?a:"")}return null}function E(e,t,r="smooth",n){var c;if(t<=0)return!1;if(n){let a=N(e,n);if(a)return a.scrollIntoView({behavior:r,block:"start"}),!0}let l=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),u=0,i;for(;i=l.nextNode();){let a=(c=i.textContent)!=null?c:"",s=d(a);if(s!==0){if(u+s>=t){let o=i.parentElement;for(;o&&o!==e;){let T=o.tagName.toLowerCase();if(f.includes(T))break;o=o.parentElement}if((!o||o===e)&&(o=i.parentElement),o)return o.scrollIntoView({behavior:r,block:"start"}),!0;break}u+=s}}return!1}function C(e){return x(e,0)}return H(S);})();\n';
