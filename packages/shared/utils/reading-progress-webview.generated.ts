// This file is auto-generated by scripts/build-webview-js.ts
// Do not edit manually. Run: pnpm --filter @karakeep/shared generate:webview-js
// Sources: reading-progress-webview-src.ts, reading-progress-core.ts

/**
 * WebView-compatible JavaScript for reading progress tracking.
 * Designed for React Native WebView injection.
 * Uses window-level scrolling only (no container scrolling detection).
 *
 * Exposes these functions on the __readingProgress global:
 * - normalizeText(text)
 * - normalizeTextLength(text)
 * - extractAnchorText(element)
 * - findParagraphByAnchor(container, anchor)
 * - getReadingPosition(container)
 * - scrollToReadingPosition(container, offset, behavior, anchor)
 */
export const READING_PROGRESS_WEBVIEW_JS =
  '"use strict";var __readingProgress=(()=>{var h=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var L=(e,t)=>{for(var r in t)h(e,r,{get:t[r],enumerable:!0})},b=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of R(t))!P.call(e,l)&&l!==r&&h(e,l,{get:()=>t[l],enumerable:!(n=E(t,l))||n.enumerable});return e};var k=e=>b(h({},"__esModule",{value:!0}),e);var N={};L(N,{extractAnchorText:()=>u,findParagraphByAnchor:()=>x,getReadingPosition:()=>S,normalizeText:()=>f,normalizeTextLength:()=>p,scrollToReadingPosition:()=>d});var T=["p","h1","h2","h3","h4","h5","h6","li","blockquote"],m=T.join(", ");function f(e){return e.replace(/[\\n\\r\\t]+/g," ").replace(/\\s+/g," ").trim()}function p(e){return f(e).length}function u(e){var r;let t=(r=e.textContent)!=null?r:"";return f(t).slice(0,50)}function x(e,t){if(!t)return null;let r=Array.from(e.querySelectorAll(m));for(let n of r)if(u(n)===t)return n;for(let n of r)if(u(n).slice(0,20)===t.slice(0,20)&&t.length>=20)return n;return null}function d(e,t,r="smooth",n){var s;if(t<=0)return!1;if(n){let i=x(e,n);if(i)return i.scrollIntoView({behavior:r,block:"start"}),!0}let l=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),g=0,a;for(;a=l.nextNode();){let i=(s=a.textContent)!=null?s:"",c=p(i);if(c!==0){if(g+c>=t){let o=a.parentElement;for(;o&&o!==e;){let A=o.tagName.toLowerCase();if(T.includes(A))break;o=o.parentElement}if((!o||o===e)&&(o=a.parentElement),o)return o.scrollIntoView({behavior:r,block:"start"}),!0;break}g+=c}}return!1}function S(e){var i;let t=e.querySelectorAll(m);if(t.length===0)return null;let r=0,n=null;for(let c of t){let o=c.getBoundingClientRect();if(o.top>=r){n=c;break}if(o.top<r&&o.bottom>r){n=c;break}}if(!n)return null;let l=u(n),g=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),a=0,s;for(;s=g.nextNode();){if(n.contains(s))return{offset:a,anchor:l};a+=p((i=s.textContent)!=null?i:"")}return{offset:a,anchor:l}}return k(N);})();\n';
