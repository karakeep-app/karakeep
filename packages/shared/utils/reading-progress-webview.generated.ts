// This file is auto-generated by scripts/build-webview-js.ts
// Do not edit manually. Run: pnpm --filter @karakeep/shared generate:webview-js
// Sources: reading-progress-webview-src.ts, reading-progress-core.ts

/**
 * WebView-compatible JavaScript for reading progress tracking.
 * Designed for React Native WebView injection.
 * Uses window-level scrolling only (no container scrolling detection).
 *
 * Exposes these functions on the __readingProgress global:
 * - getReadingPosition(container)
 * - scrollToReadingPosition(container, offset, behavior, anchor)
 */
export const READING_PROGRESS_WEBVIEW_JS =
  '"use strict";var __readingProgress=(()=>{var m=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var k=Object.prototype.hasOwnProperty;var N=(e,t)=>{for(var l in t)m(e,l,{get:t[l],enumerable:!0})},C=(e,t,l,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of b(t))!k.call(e,i)&&i!==l&&m(e,i,{get:()=>t[i],enumerable:!(r=A(t,i))||r.enumerable});return e};var H=e=>C(m({},"__esModule",{value:!0}),e);var w={};N(w,{getReadingPosition:()=>L,scrollToReadingPosition:()=>P});var d=["p","h1","h2","h3","h4","h5","h6","li","blockquote"],x=d.join(", "),E=50;function p(e){return e.replace(/[\\n\\r\\t]+/g," ").replace(/\\s+/g," ").trim()}function R(e){return p(e).length}function T(e,t){var c,u;let l=Array.from(e.querySelectorAll(x));if(l.length===0)return null;let r=null;for(let o of l){let n=o.getBoundingClientRect();if(n.top>=t){r=o;break}if(n.top<t&&n.bottom>t){r=o;break}}if(!r)return null;let i=p((c=r.textContent)!=null?c:"").slice(0,E),g=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),a=0,s;for(;s=g.nextNode();){if(r.contains(s))return{offset:a,anchor:i};a+=R((u=s.textContent)!=null?u:"")}return null}function P(e,t,l="smooth",r){var s,c;if(t<=0)return!1;if(r){let u=Array.from(e.querySelectorAll(x)),o=null,n=r.slice(0,20);for(let f of u){let h=p((s=f.textContent)!=null?s:"").slice(0,E);if(h===r)return f.scrollIntoView({behavior:l,block:"start"}),!0;!o&&r.length>=20&&h.startsWith(n)&&(o=f)}if(o)return o.scrollIntoView({behavior:l,block:"start"}),!0}let i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),g=0,a;for(;a=i.nextNode();){let u=(c=a.textContent)!=null?c:"",o=R(u);if(o!==0){if(g+o>=t){let n=a.parentElement;for(;n&&n!==e;){let f=n.tagName.toLowerCase();if(d.includes(f))break;n=n.parentElement}if((!n||n===e)&&(n=a.parentElement),n)return n.scrollIntoView({behavior:l,block:"start"}),!0;break}g+=o}}return!1}function L(e){return T(e,0)}return H(w);})();\n';
